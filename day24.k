d:0:"day24"
n:8

c:{(&(0<#:)'r),*(0<#:)#r:&:'d=x}
ds:(n;n)#{v::c[*x];-1+|/|/{~x . v}{(~d="#")*(x+x>0)|(+-1_'0,'+x)|(+1_'(+x),'0)|(1_'x,'0)|(0,'-1_'x)}/d=*|x}',/("0"+!n),/:\:("0"+!n)

&/{+/0 ds':x}'cmb n	/ 462
&/{+/0 ds':x,0}'cmb n	/ 676
