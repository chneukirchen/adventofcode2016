/ use q 2016.03.14
d:"zpqevtbw"

k:,/$-15!d,$:
r:()
{64>#r}{ t::{~|/(1=#?:)'{1_x,y}\[3#0;k x]}(1+)/x
  p:: 5#k[t]@*&(1=#?:)'{1_x,y}\[3#0;k t]
  $[#&{#ss[x;p]}'k't+1+!1000; r,:t;]
  t+1 }/0;
*|r	/ 16106

r:()
h:(,-1)!,""
s:{$[x in !h;h[x];:h[x]:2016(,/$-15!)/(,/$-15!d,$:x)]}
{64>#r}{ t::{~|/(1=#?:)'{1_x,y}\[3#0;s x]}(1+)/x
  -1@($t)," ",($#r)
  p:: 5#s[t]@*&(1=#?:)'{1_x,y}\[3#0;s t]
  $[#&{#ss[x;p]}'s't+1+!1000; r,:t;]
  t+1 }/0;
*|r	/ 22423
